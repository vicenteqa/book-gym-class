name: Template

on:
    workflow_call:
        inputs:
            activity:
                description: 'Activity name, aka the class to book'
                required: true
                type: string
            activity_time:
                description: 'Time of the activity on the schedule of the gym in the format HH:MM'
                required: true
                type: string
            base_url:
                description: 'Base URL of the gym website'
                required: true
                type: string
            gymusername:
                description: 'Username to login to the gym website'
                required: true
                type: string
            password:
                description: 'Password to login to the gym website'
                required: true
                type: string

env:
    ACTIVITY: ${{ inputs.activity }}
    ACTIVITY_TIME: ${{ inputs.activity_time }}
    BASE_URL: ${{ inputs.base_url }}
    GYMUSERNAME: ${{ inputs.gymusername }}
    PASSWORD: ${{ inputs.password }}

jobs:
    test:
        timeout-minutes: 60
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - uses: actions/setup-node@v4
              with:
                  node-version: 18
            - name: Install dependencies
              run: npm ci
            - name: Install Playwright Browsers
              run: npx playwright install --with-deps
            - name: Run Playwright tests
              run: npx playwright test
            - uses: actions/upload-artifact@v4
              if: ${{ !cancelled() }}
              with:
                  name: playwright-report
                  path: playwright-report/
                  retention-days: 3
